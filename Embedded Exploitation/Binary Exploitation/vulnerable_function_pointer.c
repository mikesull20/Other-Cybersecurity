#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void vulnerable_function(char *input) {
    void (*func_ptr)();  // Function pointer declaration
    void (*target_func)() = (void (*)())0x080484b6; // Address of malicious function (for demonstration)

    // Assign a legitimate function to the function pointer
    void actual_function() {
        printf("Actual function called\n");
    }

    func_ptr = actual_function;

    // Buffer to overflow
    char buffer[100];
    strcpy(buffer, input);  // Vulnerable to buffer overflow

    // Call the function pointed to by func_ptr
    func_ptr();  // This can be redirected by overwriting

    printf("Function pointer called\n");
}

void malicious_function() {
    printf("Malicious function executed!\n");
}

int main(int argc, char *argv[]) {
    if (argc > 1) {
        vulnerable_function(argv[1]);  // Pass user input to vulnerable function
    }
    return 0;
}
